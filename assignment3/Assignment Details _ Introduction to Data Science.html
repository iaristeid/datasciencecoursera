<!DOCTYPE html>
<html lang="en-US"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Assignment Details | Introduction to Data Science</title>
<link rel="stylesheet" href="Assignment%20Details%20%7C%20Introduction%20to%20Data%20Science_files/spark.css">
<link rel="stylesheet" href="Assignment%20Details%20%7C%20Introduction%20to%20Data%20Science_files/course.css">
<link rel="icon" href="https://spark-public.s3.amazonaws.com/datasci/static/images/favicon.ico">
<script src="Assignment%20Details%20%7C%20Introduction%20to%20Data%20Science_files/MathJax.js" type="text/javascript"></script><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuTitle {background-color: #CCCCCC; margin: -5px 0 0 0; text-align: center; font-style: italic; font-size: 80%; color: #444444; padding: 2px 0; overflow: hidden}
.MathJax_MenuArrow {position: absolute; right: .5em; color: #666666}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_Menu_Close {position: absolute; width: 31px; height: 31px; top: -15px; left: -15px}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style></head>

<body class="c4"><div style="display: none;" id="MathJax_Message"></div>
    
    <a href="#course-page-content" class="hidden">Skip Navigation</a>
    <div class="hidden">
        This page features MathJax technology to render mathematical formulae.
        If you are using a screen reader, please visit <a href="http://www.dessci.com/en/products/mathplayer/">MathPlayer</a> to download the plugin for your browser. Please note that this is an Internet Explorer-only plugin at this time.
    </div>

    <h1 class="hidden">Introduction to Data Science</h1>

    

<div class="course-topbar container-fluid" role="banner">

    <div class="row-fluid">
        
        <div class="span3">
          <a href="https://www.coursera.org/" class="course-topbar-logo" data-if-linkable="add-referrer"></a>
        </div>

        <div class="course-topbar-nav-container span9" style="float:right;">
            <h2 class="hidden">Top Navigation Bar</h2>

            <ul class="course-topbar-nav-list">
                <li class="course-topbar-nav-list-item">
                  <a href="https://www.coursera.org/courses" data-if-linkable="add-referrer">Courses</a>
                </li>

                                
                <li class="course-topbar-nav-list-item" tabindex="0" role="button" aria-haspopup="true" aria-expanded="false" aria-owns="course-topbar-my" data-popup="#course-topbar-my" data-popup-bind-open="mouseenter" data-popup-close="" style="cursor:pointer;" data-popup-direction="se">
                                        <a data-user-id="3397025">  
                        Eloy Díaz Álvarez 
                        <i class="icon-caret-down"></i>
                    </a>
                </li>
               
                            </ul>
        </div>
    </div>

    <div id="course-topbar-aboutus" class="course-topbar-sublist">
        <a class="course-topbar-sublist-item" href="https://www.coursera.org/about/jobs" target="_new" data-if-linkable="add-referrer">Jobs</a>
        <a class="course-topbar-sublist-item" href="https://www.coursera.org/about/team" target="_new" data-if-linkable="add-referrer">Team</a>
        <a class="course-topbar-sublist-item" href="https://www.coursera.org/about/contact" target="_new" data-if-linkable="add-referrer">Contact Us</a>
        <a class="course-topbar-sublist-item" href="https://www.coursera.org/about/" target="_new" data-if-linkable="add-referrer">About Us</a>
    </div>

    <div id="course-topbar-my" class="course-topbar-sublist">
        <a class="course-topbar-sublist-item" href="https://www.coursera.org/" target="_new">Courses</a>
        <a class="course-topbar-sublist-item" href="https://www.coursera.org/account/profile" target="_new">Profile</a>
        <a class="course-topbar-sublist-item" href="https://www.coursera.org/account/records" target="_new">Course Records</a>
        <a class="course-topbar-sublist-item" href="https://www.coursera.org/account/settings" target="_new">Settings</a>
        <a class="course-topbar-sublist-item" href="https://class.coursera.org/datasci-001/class/preferences">Course Preferences</a>
        <a class="course-topbar-sublist-item" href="https://class.coursera.org/datasci-001/auth/logout">Sign Out</a>
    </div>

</div>








<style type="text/css">
 


</style>
<div class="course-topbanner">
  <div class="course-topbanner-university-logo">
    <a href="https://www.coursera.org/uw" class="coursera-university-color" target="_blank" data-if-linkable="add-referrer" title="https://www.coursera.org/uw">
      <img src="Assignment%20Details%20%7C%20Introduction%20to%20Data%20Science_files/university_logo.png" alt="uw">
    </a>
  </div>

  
  <h1 class="course-topbanner-header">
      <a class="course-topbanner-name coursera-university-color" href="https://class.coursera.org/datasci-001/class/index" data-if-linkable="modal-lock">
        Introduction to Data Science      </a>
      <br>
      <span class="course-topbanner-instructor" style="">
        by  Bill  Howe      </span>
  </h1>
</div>
    
        <div class="container-fluid" style="position:relative;">
        <div class="row-fluid">
            <div id="course-page-sidebar" role="navigation">
                <div class="course-navbar-container">
	<a href="https://class.coursera.org/datasci-001/class/index">
	<img src="Assignment%20Details%20%7C%20Introduction%20to%20Data%20Science_files/logo.png" style="width: 205px;height: 116px;margin: -15px 0px 8px 1px; box-shadow: 0 1px 1px 0 rgba(0, 0, 0, 0.05);" alt="Course Home Page">
	</a>


<h2 class="hidden">Side Navigation Bar</h2>
<ul class="course-navbar-list">
		
	<li class="course-navbar-item">
								<a href="https://class.coursera.org/datasci-001/class/index" data-if-linkable="modal-lock,gray,lock-icon" class="coursera-university-color">
				
				Home							</a>
						</li>
	
		
	<li class="course-navbar-item">
								<a href="https://class.coursera.org/datasci-001/lecture/index" data-if-linkable="modal-lock,gray,lock-icon" class="coursera-university-color">
				
				Video Lectures							</a>
						</li>
	
		
	<li class="course-navbar-item">
								<a href="https://class.coursera.org/datasci-001/forum/index" data-if-linkable="modal-lock,gray,lock-icon" class="coursera-university-color">
				
				Discussion Forums							</a>
						</li>
	
		
	<li class="course-navbar-item">
								</li>
	
		
	<li class="course-navbar-item active">
								<a href="https://class.coursera.org/datasci-001/assignment/index" data-if-linkable="modal-lock,gray,lock-icon" class="coursera-university-color">
				
				Programming Assignments							<span class="course-navbar-selected-marker">(selected)</span></a>
						</li>
	
		
	<li class="course-navbar-item">
								<a href="https://class.coursera.org/datasci-001/quiz/index" data-if-linkable="modal-lock,gray,lock-icon" class="coursera-university-color">
				
				Quizzes							</a>
						</li>
	
		
	<li class="course-navbar-item">
								<a href="https://class.coursera.org/datasci-001/human_grading/index" data-if-linkable="modal-lock,gray,lock-icon" class="coursera-university-color">
				
				Peer Assessments							</a>
						</li>
	
		
	<li class="course-navbar-item">
								<a href="https://class.coursera.org/datasci-001/wiki/view?page=OptionalRealWorldProject" data-if-linkable="modal-lock,gray,lock-icon" class="coursera-university-color">
				
				Optional Real-World Project							</a>
						</li>
	
		
	<li class="course-navbar-item">
								</li>
	
		
	<li class="course-navbar-item">
								<a href="https://class.coursera.org/datasci-001/wiki/view?page=syllabus" data-if-linkable="modal-lock,gray,lock-icon" class="coursera-university-color">
				
				Syllabus							</a>
						</li>
	
		
	<li class="course-navbar-item">
								<a href="https://class.coursera.org/datasci-001/wiki/view?page=courselogistics" data-if-linkable="modal-lock,gray,lock-icon" class="coursera-university-color">
				
				Course Logistics							</a>
						</li>
	
		
	<li class="course-navbar-item">
								<a href="https://class.coursera.org/datasci-001/wiki/view?page=tableau_aws" data-if-linkable="modal-lock,gray,lock-icon" class="coursera-university-color">
				
				Running Tableau on AWS							</a>
						</li>
	
		
	<li class="course-navbar-item">
								<a href="https://class.coursera.org/datasci-001/wiki/view?page=ClassVirtualMachine" data-if-linkable="modal-lock,gray,lock-icon" class="coursera-university-color">
				
				Class Virtual Machine							</a>
						</li>
	
		
	<li class="course-navbar-item">
								<a href="https://class.coursera.org/datasci-001/wiki/view?page=GithubInstructions" data-if-linkable="modal-lock,gray,lock-icon" class="coursera-university-color">
				
				Github Instructions							</a>
						</li>
	
		
	<li class="course-navbar-item">
								<a href="https://class.coursera.org/datasci-001/wiki/view?page=PythonResources" data-if-linkable="modal-lock,gray,lock-icon" class="coursera-university-color">
				
				Python Resources							</a>
						</li>
	
		
	<li class="course-navbar-item">
								<a href="https://class.coursera.org/datasci-001/wiki/view?page=awssetup" data-if-linkable="modal-lock,gray,lock-icon" class="coursera-university-color">
				
				AWS Setup							</a>
						</li>
	
		
	<li class="course-navbar-item">
								</li>
	
		
	<li class="course-navbar-item">
								<a href="https://class.coursera.org/datasci-001/quiz/index?quiz_type=survey" data-if-linkable="modal-lock,gray,lock-icon" class="coursera-university-color">
				
				Surveys							</a>
						</li>
	
		
	<li class="course-navbar-item">
								<a href="https://class.coursera.org/datasci-001/wiki/view?page=aboutus" data-if-linkable="modal-lock,gray,lock-icon" class="coursera-university-color">
				
				About Us							</a>
						</li>
	
	
		<li class="course-navbar-item">
		<a href="https://share.coursera.org/wiki/index.php/datasci:Main" target="_blank" class="coursera-university-color" title="Open course wiki in new window">
			Course Wiki
			<span class="icon-share"></span>
		</a>
	</li>
		
		<li class="course-navbar-item">
		<a href="http://www.meetup.com/Coursera/" target="_blank" class="coursera-university-color">
			Join a Meetup
			<span class="icon-share"></span>
		</a>
	</li>
	
    </ul>

<ul style="list-style-type:none;margin-left: 10px;">
  <li><a href="http://help.coursera.org/" class="coursera-university-color" target="_blank" title="Open help articles in new window"><i class="icon-question-sign"></i> Help Articles</a></li>
</ul>

<ul style="list-style-type:none;margin-left: 10px;">
	
</ul>

</div>
            </div>
            <div id="course-page-content" role="main">
                                <h2 class="course-page-header">
  <span>Algorithms in MapReduce: Instructions</span>

  <a class="coursera-reporter-link" title="Click here if you're experiencing technical problems or found errors in the course materials." target="_blank" href="https://class.coursera.org/datasci-001/class/reporter?url=http%3A%2F%2Fclass.coursera.org%2Fdatasci-001%2Fassignment%2Fview%3Fassignment_id%3D5&amp;area=programming&amp;title=Algorithms+in+MapReduce">
     Help
  </a>
</h2>

<br>
<p>When you're ready to submit your solution, go to the <a href="https://class.coursera.org/datasci-001/assignment/list">assignments list</a>.
</p>

<br>
<p>



<title>Assignment 3 - MapReduce</title>




</p><p class="c2"><span>In this assignment, you will be designing and 
implementing MapReduce algorithms for a variety of common data 
processing tasks. &nbsp;</span></p><p class="c1"><span></span></p>


<p class="c2"><span>The MapReduce programming model (and a corresponding
 system) was proposed in a 2004 paper from a team at Google as a simpler
 abstraction for processing very large datasets in parallel. &nbsp;The 
goal of this assignment is to give you experience “thinking in 
MapReduce.” &nbsp;We will be using small datasets that you can inspect 
directly to determine the correctness of your results and to internalize
 how MapReduce works. &nbsp;In the next assignment, you will have the 
opportunity to use a MapReduce-based system to process the very large 
datasets for which is was designed. </span></p>

<p class="c1"><span></span></p><p class="c2"><span>As always, the first 
thing to do is to update your provided course materials using git pull. 
These resources may have changed since the last time you interacted with
 the datasci_course_materials repository. </span><span class="c5"><a class="c6" href="https://class.coursera.org/datasci-001/wiki/view?page=GithubInstructions">Github Instructions</a></span><span>.</span></p><p class="c1"><span></span></p><p class="c2"><span>Next, review the lectures to make sure you understand the programming model.</span></p>

<p class="c1"><span></span></p><p class="c2"><span>You may also want to experiment running your queries on the </span><span class="c5"><a class="c6" href="http://jsmapreduce.com/">JSMapReduce</a></span><span>&nbsp;service for this assignment to see what it would be like to run a MapReduce query on a cluster of machines.</span></p>

<h1 class="c2"><a name="h.3tbq75m5ftht"></a><span>Python MapReduce Framework</span></h1>


<p class="c2"><span>You will be provided with a python library called 
MapReduce.py that implements the MapReduce programming model. The 
framework faithfully implements the MapReduce programming model, but it 
executes entirely on a single machine -- it </span><span>does not involve parallel computation. </span></p><p class="c1"><span class="c3"></span></p>


<p class="c2"><span>Here is the word count example discussed in class implemented as a MapReduce program using the framework:</span></p><p class="c1"><span></span></p><p class="c2">



</p><pre># Part 1
mr = MapReduce.MapReduce()

# Part 2
def mapper(record):
    # key: document identifier
    # value: document contents
    key = record[0]
    value = record[1]
    words = value.split()
    for w in words:
      mr.emit_intermediate(w, 1)

# Part 3
def reducer(key, list_of_values):
    # key: word
    # value: list of occurrence counts
    total = 0
    for v in list_of_values:
      total += v
    mr.emit((key, total))

# Part 4
inputdata = open(sys.argv[1])
mr.execute(inputdata, mapper, reducer)
</pre>


<p class="c2"><span>In Part 1, we create a MapReduce object that is used
 to pass data between the map function and the reduce function; you 
won’t need to use this object directly. </span></p><p class="c1"><span class="c3"></span></p>

<p class="c2"><span>In Part 2, the mapper function tokenizes each 
document and emits a key-value pair. The key is a word formatted as a 
string and the value is the integer 1 to indicate an occurrence of word.</span></p><p class="c1"><span class="c3"></span></p>

<p class="c2"><span>In Part 3, the reducer function sums up the list of 
occurrence counts and emits a count for word. Since the mapper function 
emits the integer 1 for each word, each element in the list_of_values is
 the integer 1. </span></p><p class="c1"><span class="c3"></span></p>

<p class="c2"><span>The list of occurrence counts is summed and a (word, total) tuple is emitted where word is a string and total is an integer.</span></p><p class="c1"><span class="c3"></span></p>

<p class="c2"><span>In Part 4, the code loads the json file and executes the MapReduce query which prints the result to stdout.</span></p><p class="c1"><span class="c3"></span></p>

<h1 class="c2"><a name="h.z2ensvw7f47"></a><span>Submission Details</span></h1>

<p class="c2"><span>For each problem, you will turn in a python script, 
similar to wordcount.py, that solves the problem using the supplied 
MapReduce framework.</span></p>

<p class="c2"><span>When testing, make sure MapReduce.py is in the same folder as the solution script.</span></p>

<p class="c1"><span></span></p><p class="c2"><span>Solution data will be provided for each problem in the solutions folder.</span></p><p class="c1"><span></span></p><p class="c2"><span>Your
 python submission scripts are required to have a mapper function that 
accepts at least 1 argument and a reducer function that accepts at least
 2 arguments. Your submission is also required to have a global variable
 named mr which points to a MapReduce object. If you solve the problems 
by simply replacing the mapper and reducer functions in wordcount.py, 
then this is guaranteed.</span></p>

<h1 class="c2"><a name="h.fd8hvvga4dhn"></a><span>Problem 1</span></h1>

<p class="c2"><span>Create an Inverted index. Given a set of documents, 
an inverted index is a dictionary where each word is associated with a 
list of the document identifiers in which that word appears. &nbsp;</span></p>



<h2 class="c2"><a name="h.6wfahzap4wjh"></a><span>Mapper Input</span></h2><p class="c2"><span>The input is a 2 element list: [document_id, text]</span></p><p class="c1"><span></span></p>


<p class="c2"><span>document_id</span><span>: document identifier formatted as a string</span></p><p class="c2"><span>text: text of the document formatted as a string</span></p><p class="c1"><span></span></p><p class="c2"><span>The
 document text may have words in various cases or elements of 
punctuation. Do not modify the string, and treat each token as if it was
 a valid word. (That is, just use value.split())</span></p>


<h2 class="c2"><a name="h.422xhborqmcf"></a><span>Reducer Output</span></h2>


<p class="c2"><span>The output should be a (word, document ID list) tuple where word is a String and document ID list is a list of Strings.</span></p><p class="c1"><span></span></p><p class="c2"><span>You can test your solution to this problem using books.json:</span></p><p class="c2"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;python inverted_index.py books.json</span></p><p class="c1"><span></span></p><p class="c2"><span>You can verify your solution against inverted_index.json.</span></p>

<h1 class="c2"><a name="h.h9ky98lavkt4"></a><span>Problem 2</span></h1>

<p class="c2"><span>Implement a relational join as a MapReduce query</span></p><p class="c1"><span></span></p><p class="c2"><span>Consider the query: </span></p><p class="c1"><span></span></p><pre><p class="c0"><span>SELECT * </span></p><p class="c0"><span>FROM Orders, LineItem </span></p><p class="c0"><span>WHERE Order.</span><span>order_id</span><span>&nbsp;= LineItem.</span><span>order_id</span></p></pre><p class="c1"><span></span></p><p class="c2"><span>Your
 MapReduce query should produce the same information as this SQL query. 
&nbsp;You can consider the two input tables, Order and LineItem, as one 
big concatenated bag of records which gets fed into the map function 
record by 
record.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>


<h2 class="c2"><a name="h.6ye6vrctfux2"></a><span>Map Input</span></h2>


<p class="c2"><span>The input will be database records formatted as lists of Strings. </span></p><p class="c1"><span></span></p><p class="c2"><span>Every list element corresponds to a different field in it’s corresponding record.</span></p><p class="c1"><span></span></p><p class="c2"><span>The
 first item(index 0) in each record is a string that identifies which 
table the record originates from. This field has two possible values:</span></p><p class="c1"><span></span></p><p class="c2"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‘line_item’ indicates that the record is a line item.</span></p><p class="c2"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‘order’ indicates that the record is an order.</span></p><p class="c1"><span></span></p><p class="c2"><span class="c7">The second element(index 1) in each record is the order_id.</span></p><p class="c1"><span></span></p><p class="c2"><span>LineItem records have 17 elements including the identifier string.</span></p><p class="c2"><span>Order records have 10 elements including the identifier string.</span></p>

<h2 class="c2"><a name="h.1jod59f5lohi"></a><span>Reduce Output</span></h2>

<p class="c2"><span>The output should be a joined record. </span></p><p class="c1"><span></span></p><p class="c2"><span>The
 result should be a single list of length 27 that contains the fields 
from the order record followed by the fields from the line item record. 
Each list element should be a string.</span></p><p class="c1"><span></span></p><p class="c2"><span>You can test your solution to this problem using records.json:</span></p><p class="c1"><span></span></p><p class="c2"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;python join.py records.json</span></p><p class="c1"><span></span></p><p class="c2"><span>You can verify your solution against join.json.</span></p>

<h1 class="c2"><a name="h.2ahw0eaykvi1"></a><span>Problem 3</span></h1>

<p class="c2"><span>Consider a simple social network dataset consisting 
of key-value pairs where each key is a person and each value is a friend
 of that person. Describe a MapReduce algorithm to count he number of 
friends each person has.</span></p>

<h2 class="c2"><a name="h.6bmaxr6905fq"></a><span>Map Input</span></h2>

<p class="c2"><span>The input is a 2 element list: [personA, personB]</span></p><p class="c1"><span></span></p><p class="c2"><span>personA: Name of a person formatted as a string</span></p><p class="c2"><span>personB: Name of one of personA’s friends formatted as a string</span></p><p class="c1"><span></span></p><p class="c2"><span>This implies that personB is a friend of personA, but it does not imply that personA is a friend of personB.</span></p>

<h2 class="c2"><a name="h.f3410fx887ut"></a><span>Reduce Output</span></h2>

<p class="c2"><span>The output should be a (person, &nbsp;friend count) tuple.</span></p><p class="c1"><span></span></p><p class="c2"><span>person is a string and friend count is an integer describing the number of friends ‘person’ has.</span></p><p class="c1"><span></span></p><p class="c2"><span>You can test your solution to this problem using friends.json:</span></p><p class="c1"><span></span></p><p class="c2"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;python friend_count.py friends.json</span></p><p class="c1"><span></span></p><p class="c2"><span>You can verify your solution against friend_count.json.</span></p>

<h1 class="c2"><a name="h.mlntsqdvmosb"></a><span>Problem 4</span></h1>

<p class="c2"><span>The relationship "friend" is often symmetric, 
meaning that if I am your friend, you are my friend. Implement a 
MapReduce algorithm to check whether this property holds. Generate a 
list of all non-symmetric friend relationships.</span></p>

<h2 class="c2"><a name="h.40menlv78i9q"></a><span>Map Input</span></h2>

<p class="c2"><span>The input is a 2 element list: [personA, personB]</span></p><p class="c1"><span></span></p><p class="c2"><span>personA: Name of a person formatted as a string</span></p><p class="c2"><span>personB: Name of one of personA’s friends formatted as a string</span></p><p class="c1"><span></span></p><p class="c2"><span>This implies that personB is a friend of personA, but it does not imply that personA is a friend of personB.</span></p>

<h2 class="c2"><a name="h.atam3upnj7wp"></a><span>Reduce Output</span></h2>

<p class="c2"><span>The output should be the (person, friend) and (friend, person) tuples</span><span>&nbsp;for each asymmetric friendship.</span></p><p class="c1"><span></span></p><p class="c2"><span>Note
 however that only one of the (person, friend) or (friend, person) 
output tuples will exist in the input. This indicates friendship 
asymmetry.</span></p><p class="c1"><span></span></p><p class="c2"><span>You can test your solution to this problem using friends.json:</span></p><p class="c1"><span></span></p><p class="c2"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;python asymmetric_friendships.py friends.json</span></p><p class="c1"><span></span></p><p class="c2"><span>You can verify your solution against asymmetric_friendships.json.</span></p>

<h1 class="c2"><a name="h.ij0093ty3nzb"></a><span>Problem 5</span></h1>

<p class="c2"><span>Consider a set of key-value pairs where each key is 
sequence id and each value is a string of nucleotides, e.g., 
GCTTCCGAAATGCTCGAA....</span></p><p class="c1"><span></span></p><p class="c2"><span>Write a MapReduce query to </span><span>remove the</span><span>&nbsp;last 10 characters from each string of nucleotides, then remove any duplicates generated.</span></p>

<h2 class="c2"><a name="h.w3h6jckflvf2"></a><span>Map Input</span></h2>

<p class="c2"><span>The input is a 2 element list: [sequence id, nucleotides]</span></p><p class="c1"><span></span></p><p class="c2"><span>sequence id: Unique identifier formatted as a string</span></p><p class="c2"><span>nucleotides: Sequence of nucleotides formatted as a string</span></p>

<h2 class="c2"><a name="h.qe91piigvpbp"></a><span>Reduce Output</span></h2>

<p class="c2"><span>The output from the reduce function should be the unique trimmed nucleotide strings.</span></p><p class="c1"><span></span></p><p class="c2"><span>You can test your solution to this problem using dna.json:</span></p><p class="c1"><span></span></p><p class="c2"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;python unique_trims.py dna.json</span></p><p class="c1"><span></span></p><p class="c2"><span>You can verify your solution against unique_trims.json.</span></p>

<h1 class="c2"><a name="h.py5o4bb6eenk"></a><span>Problem 6</span></h1>

<p class="c2"><span>Assume you have two matrices A and B in a sparse 
matrix format, where each record is of the form i, j, value. 
&nbsp;Design a MapReduce algorithm to compute matrix multiplication: A x
 B</span></p>

<h2 class="c2"><a name="h.aqh2zputdew"></a><span>Map Input</span></h2>

<p class="c2"><span>The input to the map function will be matrix row 
records formatted as lists. Each list will have the format [matrix, i, 
j, value] where matrix is a string and i, j, and value are integers.</span></p><p class="c1"><span></span></p><p class="c2"><span>The first item, matrix, is a string that identifies which matrix the record originates from. This field has two possible values:</span></p><p class="c1"><span></span></p><p class="c2"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‘a’ indicates that the record is from matrix A</span></p><p class="c2"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‘b’ indicates that the record is from matrix B</span></p><p class="c1"><span></span></p>

<h2 class="c2"><a name="h.1fvr2xt4geu5"></a><span>Reduce Output</span></h2>

<p class="c2"><span>The output from the reduce function will also be 
matrix row records formatted as tuples. Each tuple will have the format 
(i, j, value) where each element is an integer.</span></p><p class="c1"><span></span></p><p class="c2"><span>You can test your solution to this problem using matrix.json:</span></p><p class="c1"><span></span></p><p class="c2"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;python multiply.py matrix.json</span></p><p class="c1"><span></span></p><p class="c2"><span>You can verify your solution against multiply.json.</span></p><p></p>

            </div>
        </div>
    </div>
        
    
    <script src="Assignment%20Details%20%7C%20Introduction%20to%20Data%20Science_files/204.js" async="" type="text/javascript"></script><script src="Assignment%20Details%20%7C%20Introduction%20to%20Data%20Science_files/ga.js" async="" type="text/javascript"></script><script src="Assignment%20Details%20%7C%20Introduction%20to%20Data%20Science_files/spark.js"></script>

<script type="text/javascript">
    // SET UP THE MULTITRACKER
        window.logger = window.Log({level:"error"});
        var parts = location.host.split(".");
    while(parts.length > 2) { parts.shift(); }

    window.multitracker = window.MultiTracker({logger:window.logger});
    window.multitracker.register('204', window._204 = window._204 || []);
    window.multitracker.register('ga', window._gaq = window._gaq || [], 'google');

    // SET UP GA and 204
    window._gaq.push(['_setAccount', 'UA-28377374-1']);
    window._gaq.push(['_setDomainName', 'coursera.org']);
    window._gaq.push(['_setAllowLinker', true]);  
    window._gaq.push(['_trackPageview']);
    
    window._204.push({key:"pageview", val:{}});
    window._204.push(["client", "spark"]);
    window._204.push(["user", 3397025]);
    window._204.push(["domain", "." + parts.join(".")]);

    // override our multitracker queues with the ga queue when it is ready
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    
      ga.onload = ga.onreadystatechange = function() {
          ga.onreadystatechange = ga.onload = null;
          window.multitracker.get('ga').queue = window._gaq;
      };
    })();

    // override our multitracker queues with the 204 queue when it is ready
    (function() {
      var a = document.createElement('script'); a.type = 'text/javascript'; a.async = true;
      a.src = 'https://eventing.coursera.org/204.min.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(a, s);
      a.onload = a.onreadystatechange = function() {
          a.onreadystatechange = a.onload = null;
          window.multitracker.get('204').queue = window._204;
      };
    })();
</script>

<script>
  // Set up shared AB testing object
  (function() {
    window.ab = {};

    // we want to share the 204 session cookie with the AB session cookie...
    var sessionId = AB.makeSession("__204u", {expires:356, domain:"." + location.host});
        var debug = true;
    
    window.ab.user = window.AB(3397025, "user", {debug:debug, tracker:window.multitracker, logger:window.logger});
    window.ab.session = window.AB(sessionId, "session", {debug:debug, tracker:window.multitracker, logger:window.logger});

    if(window.CourseraABExperiments.user) {
        window.ab.user.addExperiments(window.CourseraABExperiments.user);
        window.ab.user.runExperimentsOn("body");
    }

    if(window.CourseraABExperiments.session) {
        window.ab.session.addExperiments(window.CourseraABExperiments.session);
        window.ab.session.runExperimentsOn("body");
    }
  })();
</script>


    <script>
      // Set up help widget
      (function() {
        $("[data-helpwidget]").each(function() {
            window.HelpWidget(this, {tracker: window.multitracker});
        });
       })();
 
        $("[data-readme]").each(function() {
            window.ReadMe(this);
        });
    </script>

    <script src="Assignment%20Details%20%7C%20Introduction%20to%20Data%20Science_files/modal_focus.js" type="text/javascript"></script>
    <script src="Assignment%20Details%20%7C%20Introduction%20to%20Data%20Science_files/get_query_parameters.js" type="text/javascript"></script>
    <script src="Assignment%20Details%20%7C%20Introduction%20to%20Data%20Science_files/signature_track.js" type="text/javascript"></script>
    <script src="Assignment%20Details%20%7C%20Introduction%20to%20Data%20Science_files/item_list.js" type="text/javascript"></script>
    <script src="Assignment%20Details%20%7C%20Introduction%20to%20Data%20Science_files/navbar.js" type="text/javascript"></script>

    
    <script>
     // Set up help widget
      (function() {
        $("[data-helpwidget]").each(function() {
            window.HelpWidget(this, {tracker: window.multitracker});
        });
       })();
    </script>

    
    <script type="text/x-mathjax-config;executed=true">
MathJax.Hub.Config({
  config: ["MMLorHTML.js"],
  
  styleSheets: [],
  styles: {},

  jax: ["input/TeX"],
  
  extensions: ["tex2jax.js"],

  preJax: null,
  postJax: null,

  preRemoveClass: "MathJax_Preview",

  showProcessingMessages: true,

  messageStyle: "none",
  
  displayAlign: "center",
  displayIndent: "0em",
  
  delayStartupUntil: "none",

  skipStartupTypeset: false,
  
  elements: [],
  
  tex2jax: {
	    inlineMath: [
	                 ['$$','$$'],      // uncomment this for standard TeX math delimiters
	                 ['\\(','\\)']
	                 ],

	                 displayMath: [
	                 ['\\[','\\]']
	                 ],

    skipTags: ["script","noscript","style","textarea","pre","code"],
    ignoreClass: "tex2jax_ignore",
    processClass: "tex2jax_process",
    processEscapes: false,
    processEnvironments: true,
    preview: "TeX"
    
  },
  
  mml2jax: {
    preview: "alttext"
    
  },
  
  jsMath2jax: {
    preview: "TeX"
    
  },

  TeX: {
    TagSide: "right",
    TagIndent: ".8em",
    MultLineWidth: "85%",
    Macros: {},

    extensions: ["AMSmath.js", "AMSsymbols.js"]
    
  },

  //============================================================================
  //
  //  These parameters control the MathML inupt jax.
  //
  MathML: {
    //
    //  This specifies whether to use TeX spacing or MathML spacing when the
    //  HTML-CSS output jax is used.
    //
    useMathMLspacing: false
  },
  
  //============================================================================
  //
  //  These parameters control the HTML-CSS output jax.
  //
  "HTML-CSS": {
    
    scale: 100,
    
    availableFonts: ["STIX","TeX"],
    
    preferredFont: "TeX",
    
    webFont: "TeX",
    
    imageFont: "TeX",
    
    undefinedFamily: "STIXGeneral,'Arial Unicode MS',serif",
      
    showMathMenu: true,

    styles: {},
    
    tooltip: {
      delayPost: 600,          // milliseconds delay before tooltip is posted after mouseover
      delayClear: 600,         // milliseconds delay before tooltip is cleared after mouseout
      offsetX: 10, offsetY: 5  // pixels to offset tooltip from mouse position
    }
  },
  
  //============================================================================
  //
  //  These parameters control the NativeMML output jax.
  //
  NativeMML: {

    scale: 100,

    showMathMenu: true,
    showMathMenuMSIE: true,

    styles: {}
  },
  
  MathMenu: {
    delay: 400,
    
    helpURL: "http://www.mathjax.org/help/user/",

    showRenderer: true,
    showFontMenu: false,
    showContext:  false,

    windowSettings: {
      status: "no", toolbar: "no", locationbar: "no", menubar: "no",
      directories: "no", personalbar: "no", resizable: "yes", scrollbars: "yes",
      width: 100, height: 50
    },
    
    styles: {}
    
  },

  MMLorHTML: {
    prefer: {
      MSIE:    "MML",
      Firefox: "MML",
      Opera:   "HTML",
      other:   "HTML"
    }
  }
});
</script>
<script type="text/javascript">
(function () {

  function loadMathJax() {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://duqnjvq4jwr55.cloudfront.net/2.1/MathJax.js";
    document.getElementsByTagName("head")[0].appendChild(script);
  }

  window.loadOrRefreshMathJax = function(domId) {
    if (window.MathJax) {
      if (domId) {
        MathJax.Hub.Queue(["Typeset", MathJax.Hub, domId]);
      } else {
        MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
      }
    } else {
      loadMathJax();
    }
  }
})();
</script>
    <script type="text/javascript">
        var site_base_url = "https:\/\/www.coursera.org\/";
        var site_static_asset_url = "https:\/\/dt5zaw6a98blc.cloudfront.net\/site-static\/";
        var spark_class_short_name = "datasci";
        var spark_class_id = 346;
        var spark_class_url = "\/datasci-001";
        var spark_signature_url = "https:\/\/class.coursera.org\/datasci-001\/signature\/";
        
        var course_strings_name = "Introduction to Data Science";
        var student_full_name = "Eloy D\u00edaz \u00c1lvarez";
    </script>

    
<script type="text/javascript">$(function() { loadOrRefreshMathJax();})</script>




</body></html>